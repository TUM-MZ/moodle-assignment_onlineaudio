define(["jquery"],function(a){"use strict";var b={init:function(a){var c,d="./submission/onlineaudio/amd/src/workers/worker-realtime.js",e=function(a,b){var e,f,g=b||{},h=g.bufferLen||4096,i=g.numChannels||2;window.AudioContext=e=window.AudioContext||window.webkitAudioContext;var j=new e,k=new Worker(g.workerPath||d),l=function(){k.postMessage({cmd:"init",config:{sampleRate:48e3,numChannels:i,debug:!0}})};l();var m=function(a){var b=a.inputBuffer.getChannelData(0),c=a.inputBuffer.getChannelData(1);k.postMessage({cmd:"encode",bufferLeft:b,bufferRight:c})};this.record=function(){f=j.createMediaStreamSource(a),this.node=(j.createScriptProcessor||e.createJavaScriptNode).call(j,h,i,i),this.node.onaudioprocess=m,f.connect(this.node),this.node.connect(j.destination)},this.stop=function(){this.node.onaudioprocess=null,f.disconnect(),this.node.disconnect()},this.reset=function(){l()},this.getMP3Blob=function(a){if(c=a||g.callback,!c)throw new Error("Callback not set");k.postMessage({cmd:"finish"})},k.onmessage=function(a){var b=new Blob(a.data.buf,{type:"audio/mp3"});c(b)}};b.Recorder=e}};return b});